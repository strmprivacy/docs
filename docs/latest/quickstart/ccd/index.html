<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-quickstart/ccd">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="search" type="application/opensearchdescription+xml" title="STRM Privacy Documentation" href="/opensearch.xml">

<script src="https://plausible.io/js/plausible.js" defer="defer" data-domain="docs.strmprivacy.io"></script><title data-rh="true">Customer Cloud Deployments | STRM Privacy Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.strmprivacy.io//docs/latest/quickstart/ccd/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Customer Cloud Deployments | STRM Privacy Documentation"><meta data-rh="true" name="description" content="[cli]//github.com/strmprivacy/cli"><meta data-rh="true" property="og:description" content="[cli]//github.com/strmprivacy/cli"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://docs.strmprivacy.io//docs/latest/quickstart/ccd/"><link data-rh="true" rel="alternate" href="https://docs.strmprivacy.io//docs/latest/quickstart/ccd/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.strmprivacy.io//docs/latest/quickstart/ccd/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://M24OHV52F0-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.492ee3e4.css">
<link rel="preload" href="/assets/js/runtime~main.b6e123e7.js" as="script">
<link rel="preload" href="/assets/js/main.624fc12a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://strmprivacy.io" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="https://storage.googleapis.com/strm-media/strm-logo-orange-slim.svg" alt="STRM Privacy Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="https://storage.googleapis.com/strm-media/strm-logo-orange-slim.svg" alt="STRM Privacy Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/latest/overview/about/">Docs</a><a href="https://join.strm.team/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Hiring!</a></div><div class="navbar__items navbar__items--right"><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_dLyj"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><aside class="theme-doc-sidebar-container docSidebarContainer_UQUJ"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/latest/overview/">Overview</a><button aria-label="Toggle the collapsible sidebar category &#x27;Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/latest/concepts/">Concepts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/latest/quickstart/">Quickstart</a><button aria-label="Toggle the collapsible sidebar category &#x27;Quickstart&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/quickstart/creating-streams/">Creating Streams with the Command Line Interface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/quickstart/listen-web-socket/">Receiving events over websocket</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/quickstart/sending-curl/">Sending and receiving by hand</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/quickstart/full-example/">Examples in multiple languages</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/quickstart/exporting-kafka/">Kafka consumer in Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/quickstart/batch-exporter/">Batch Exporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/quickstart/exporting-keys/">Exporting Keys</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/quickstart/grpc/">gRPC API definition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/quickstart/simple-schema/">Simple Schema</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/latest/quickstart/ccd/">Customer Cloud Deployments</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/latest/cli-index/">CLI Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;CLI Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/contact/">Contact</a></li></ul></nav></div></aside><main class="docMainContainer_uL0j"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_kU5B"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/latest/quickstart/"><span itemprop="name">Quickstart</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Customer Cloud Deployments</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_bZGK theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_l22C">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Customer Cloud Deployments</h1></header><p>This hands-on sessions shows how to get up-and-running with your Customer Cloud Deployment, and verify its
functionality.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="make-sure-you-are-on-a-self-hosted-subscription">Make sure you are on a &#x27;Self Hosted&#x27; subscription<a class="hash-link" href="#make-sure-you-are-on-a-self-hosted-subscription" title="Direct link to heading">​</a></h2><p>Your <a href="https://console.strmprivacy.io/upgrading" target="_blank" rel="noopener noreferrer">STRM profile page</a> should show: &quot;Current subscription: Self hosted&quot;. Get in touch with your STRM
representative if you&#x27;re on a Free or Business subscription.</p><p>Once you&#x27;re on a self hosted subscription, you can proceed with this quickstart guide.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="install-the-following-tools">Install the following tools<a class="hash-link" href="#install-the-following-tools" title="Direct link to heading">​</a></h2><ul><li><a href="https://github.com/strmprivacy/cli" target="_blank" rel="noopener noreferrer"><code>strm</code></a>, the STRM Privacy cli (optional). You need this to control your STRM resources, and to simulate some events.
You could do without, and use the <a href="https://console.strmprivacy.io" target="_blank" rel="noopener noreferrer">STRM console</a>.</li><li><code>make</code> (optional): The Helm repository contains handy <code>make</code> targets such as <em>install</em>, <em>upgrade</em>, <em>wipe</em>. None of
these are mandatory, one can also execute the commands in the <a href="https://github.com/strmprivacy/data-plane-helm-chart/blob/master/Makefile" target="_blank" rel="noopener noreferrer"><code>Makefile</code></a> by hand.</li><li><a href="https://kubernetes.io/docs/tasks/tools/" target="_blank" rel="noopener noreferrer"><code>kubectl</code></a></li><li><a href="http://helm.sh" target="_blank" rel="noopener noreferrer"><code>helm</code></a> (required): This Kubernetes package manager is used for installing (and upgrading) your STRM
customer data plane.</li><li><a href="https://www.telepresence.io/" target="_blank" rel="noopener noreferrer"><code>telepresence</code></a> (optional): This tool allows your development computer to become <em>part of</em> the k8s
cluster, so that you can directly access k8s services.</li><li><a href="https://github.com/derailed/k9s" target="_blank" rel="noopener noreferrer"><code>k9s</code></a> (optional): This <em>textual user interface</em> offers a very convenient way to
interact with kubernetes clusters.</li><li><a href="https://github.com/ahmetb/kubectx" target="_blank" rel="noopener noreferrer"><code>kubectx and kubens</code></a> (optional): Very useful tools to switch the default
kubernetes context and namespace.</li><li><a href="https://docs.min.io/docs/minio-client-complete-guide.html" target="_blank" rel="noopener noreferrer"><code>minio mc</code></a> (optional). A useful tool to interact with S3 compatible object storage (including S3 by AWS
itself).</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="install-the-strm-customer-data-plane">Install the STRM customer data plane<a class="hash-link" href="#install-the-strm-customer-data-plane" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="preparation">Preparation<a class="hash-link" href="#preparation" title="Direct link to heading">​</a></h3><ol><li>Make sure you have active kubernetes credentials to a cluster: <code>kubectl get nodes</code> should show the nodes of your
cluster.</li><li>Create a namespace <code>strmprivacy</code> (<code>kubectl create namespace strmprivacy</code>) and set that as default (<code>kubens strmprivacy</code>).</li><li><code>git clone https://github.com/strmprivacy/data-plane-helm-chart.git</code>. In the near future this will become part of a
Helm repository, and this command will become <code>helm repo add ...</code>.</li><li><code>cd data-plane-helm-chart</code>.</li><li>Download the credentials file <code>values.yaml</code> through <a href="https://console.strmprivacy.io/installation/configuration" target="_blank" rel="noopener noreferrer">the STRM Privacy Console</a> into the <code>data-plane-helm-chart</code> directory.</li></ol><p>The <code>values.yaml</code> file should be similar to this:</p><div class="language-yaml codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-yaml codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">registry</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">imagePullSecret</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ewogIC....&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">license</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">installationId</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;f4cea....&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">installationClientId</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ins-....&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">installationClientSecret</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tii....&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kafka</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">redis</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">postgresql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="install-the-helm-chart">Install the Helm chart<a class="hash-link" href="#install-the-helm-chart" title="Direct link to heading">​</a></h3><p>This installs <em>all</em> the STRM components inside the <code>strmprivacy</code> namespace.</p><p><code>make install</code> should be all that is needed. <code>kubectl get pods --watch</code> or <code>k9s</code> provides nice feedback to see how the
installation is progressing. We see that some supporting infrastructure like Redis, Postgresql and Kafka are also
installed. The creation of these components can be disabled, in which case configuration to the actual components will
have to be added to the Helm chart.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="create-in-a-different-namespace">Create in a different namespace<a class="hash-link" href="#create-in-a-different-namespace" title="Direct link to heading">​</a></h3><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>This is still a work in progress, so do not use it yet.</p></div></div><p>Add <code>namespace=...</code> to every <code>make</code> command (or modify the <code>Makefile</code>)</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">make namespace namespace=mycustomnamespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make install namespace=mycustomnamespace</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="interacting-with-the-ccd-cluster">Interacting with the CCD cluster<a class="hash-link" href="#interacting-with-the-ccd-cluster" title="Direct link to heading">​</a></h2><p>First create two streams.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">strm create stream test --save</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strm create stream --derived-from test --levels 2 --save</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="via-telepresence">Via telepresence<a class="hash-link" href="#via-telepresence" title="Direct link to heading">​</a></h3><p><a href="https://www.telepresence.io/" target="_blank" rel="noopener noreferrer"><code>telepresence</code></a> is an <em>awesome tool</em> that brings your development computer via a vpn construction in the
same network as your cluster. After you&#x27;ve started the agent (<code>telepresence connect</code>), you have direct access to the
entities in your Kubernetes cluster.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>You can also use a port forward instead of telepresence. See next paragraph.</p></div></div><p>Make sure you set your default namespace via <code>kubens</code> to <code>strmprivacy</code>.</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get svc</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">NAME                              CLUSTER-IP       PORT(S)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">confluent-schema-proxy            10.3.174.226     80/TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">event-gateway                     10.3.68.45       80/TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kafka                             10.3.47.1        9092/TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kafka-headless                    None             9092/TCP,9093/TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">postgres                          10.3.125.90      5432/TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">postgres-hl                       None             5432/TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redis-hallo-headless              None             6379/TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redis-hallo-master                10.3.80.116      6379/TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redis-hallo-replicas              10.3.228.64      6379/TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strmprivacy-zookeeper             10.3.229.219     2181/TCP,2888/TCP,3888/TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strmprivacy-zookeeper-headless    None             2181/TCP,2888/TCP,3888/TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">web-socket                        10.3.21.178      80/TCP</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Because you&#x27;ve create a derived stream (<code>test-2</code>) we should be able to see a decrypter deployment:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get deployments.apps  -l </span><span class="token assign-left variable" style="color:#36acaa">app</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">decrypter-v2</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                             READY   UP-TO-DATE   AVAILABLE   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">decrypter-a268aea6-4b5b-4241-b833-9a84f4f44bc4   1/1     1            1           93m</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You could use <code>kubectl describe deployment decrypter...</code> to see the annotations on the deployment, and see that it is
indeed processing your <code>test-2</code> stream</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="sending-events-with-the-cli">Sending events with the cli<a class="hash-link" href="#sending-events-with-the-cli" title="Direct link to heading">​</a></h4><p>To simulate events with our cli, the <code>events-api-url</code> parameter must be set to the host exposed via telepresence (the url can also be set in the strm config file (<code>strm context config</code>).</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">strm simulate random-events </span><span class="token builtin class-name">test</span><span class="token plain"> --events-api-url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">http://event-gateway.strmprivacy/event --interval </span><span class="token number" style="color:#36acaa">5</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">Sent 874 events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sent 1809 events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sent 2726 events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="listening-on-the-web-socket-via-the-cli">Listening on the web-socket via the cli<a class="hash-link" href="#listening-on-the-web-socket-via-the-cli" title="Direct link to heading">​</a></h4><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">strm listen web-socket </span><span class="token builtin class-name">test</span><span class="token plain"> --web-socket-url ws://web-socket.strmprivacy/ws</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;strmMeta&quot;: {&quot;eventContractRef&quot;: &quot;strmprivacy/example/1.3.0&quot;, &quot;nonce&quot;: -447993628, &quot;timestamp&quot;: 1652181230883, &quot;keyLink&quot;: &quot;7573fc76-ae34-4c49-a3fd-d552b677ffa1&quot;, &quot;billingId&quot;: &quot;strmprodccdtest1908747604&quot;, &quot;consentLevels&quot;: [0, 1, 2, 3]}, &quot;uniqueIdentifier&quot;: &quot;AQAsswoVM2q6Q6+eeTb5Qe61xBHTaAZZMVCh+vDf&quot;, &quot;consistentValue&quot;: &quot;AQAsswoPYW8+VGwOZvfh+FmSEh2UoVTRNkNWlyQOpwA=&quot;, &quot;someSensitiveValue&quot;: &quot;AQAsswpQCKDPUYNls3hy13IllL5vd4bz/X3rEsBI0TEV&quot;, &quot;notSensitiveValue&quot;: &quot;not-sensitive-64&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;strmMeta&quot;: {&quot;eventContractRef&quot;: &quot;strmprivacy/example/1.3.0&quot;, &quot;nonce&quot;: -45323834, &quot;timestamp&quot;: 1652181230893, &quot;keyLink&quot;: &quot;9ced67fc-9227-4fb2-846b-1eed521db941&quot;, &quot;billingId&quot;: &quot;strmprodccdtest1908747604&quot;, &quot;consentLevels&quot;: [0, 1, 2]}, &quot;uniqueIdentifier&quot;: &quot;AWzkJjeWufjZehXNpWLUQ63CG1O8jxCU6MOd3Seo&quot;, &quot;consistentValue&quot;: &quot;AWzkJjd3cB+36sCrtT6va3YLjCa5qw55Iy5/HevIcVU=&quot;, &quot;someSensitiveValue&quot;: &quot;AWzkJjcsrjNHbZCAjlEYCBdlpOVK8+eXIx6BSBDxH8VQ&quot;, &quot;notSensitiveValue&quot;: &quot;not-sensitive-42&quot;}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Or a derived stream</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">strm listen web-socket test-2 --web-socket-url ws://web-socket.strmprivacy/ws</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;strmMeta&quot;: {&quot;eventContractRef&quot;: &quot;strmprivacy/example/1.3.0&quot;, &quot;nonce&quot;: -1742873135, &quot;timestamp&quot;: 1652181297380, &quot;keyLink&quot;: &quot;556c1be7-4332-4058-9d36-5e3e5a66e121&quot;, &quot;billingId&quot;: &quot;strmprodccdtest1908747604&quot;, &quot;consentLevels&quot;: [0, 1, 2]}, &quot;uniqueIdentifier&quot;: &quot;unique-81&quot;, &quot;consistentValue&quot;: &quot;session-922&quot;, &quot;someSensitiveValue&quot;: &quot;AQM0jlnxbeNZSJzvJWLpnMjyYET1Jb1Yz+5yZVB5i6Dq&quot;, &quot;notSensitiveValue&quot;: &quot;not-sensitive-78&quot;}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="via-port-forwarding">Via port forwarding<a class="hash-link" href="#via-port-forwarding" title="Direct link to heading">​</a></h3><p>For the steps described above you need to forward the ports for the <code>event-gateway</code> and the <code>web-socket</code>. To add a forwarding port to a deployment either use <code>k9s</code> and press <code>shift+f</code> on the deployments for the <code>event-gateway</code> and the <code>web-socket</code> or do the following:</p><p>Run the next two commands in separate shells, and keep them running:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl port-forward deployment/event-gateway </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain">:8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl port-forward deployment/web-socket </span><span class="token number" style="color:#36acaa">8082</span><span class="token plain">:8080</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="sending-events-with-the-cli-1">Sending events with the cli<a class="hash-link" href="#sending-events-with-the-cli-1" title="Direct link to heading">​</a></h4><p>To simulate events with our cli, you will need to change the <code>events-api-url</code> to your forwarded port on localhost:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">strm simulate random-events </span><span class="token builtin class-name">test</span><span class="token plain"> --events-api-url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">http://localhost:8080/event --interval </span><span class="token number" style="color:#36acaa">5</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="listening-on-the-web-socket-via-the-cli-1">Listening on the web-socket via the cli<a class="hash-link" href="#listening-on-the-web-socket-via-the-cli-1" title="Direct link to heading">​</a></h4><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">strm listen web-socket </span><span class="token builtin class-name">test</span><span class="token plain"> --web-socket-url ws://localhost:8082/ws</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>or derived stream</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">strm listen web-socket test-2 --web-socket-url ws://localhost:8082/ws</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="consume-from-kafka">Consume from Kafka<a class="hash-link" href="#consume-from-kafka" title="Direct link to heading">​</a></h3><p>Install the <a href="https://docs.confluent.io/platform/current/quickstart/ce-docker-quickstart.html#cp-quickstart-step-1" target="_blank" rel="noopener noreferrer">Confluent client tools</a>. You don&#x27;t have to start Confluent, you only need to add the <code>bin</code> directory
of the unpacked confluent tar file  to your <code>$PATH</code>.</p><p>You can determine the input topic of a specific decrypter (provide the full name) as follows:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get deployments.apps decrypter-</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. -o</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">jsonpath</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;{.metadata.annotations.input-topic}&#x27;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">stream-a268aea6-4b5b-4241-b833-9a84f4f44bc4</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Or alternatively, describe the deployment with <code>kubectl</code> or <code>k9s</code> and look up the value of <code>input-topic</code> under the annotations.</p><p>Then pass this topic to the kafka consumer:  </p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">    ~/Downloads/confluent-7.0.1/bin/kafka-avro-console-consumer </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --bootstrap-server kafka.strmprivacy:9092 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --topic stream-a268aea6-4b5b-4241-b833-9a84f4f44bc4 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --property schema.registry.url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">http://confluent-schema-proxy.strmprivacy/confluent </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --property print.key</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">true </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --key-deserializer</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;org.apache.kafka.common.serialization.StringDeserializer&quot;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">1867d5ad-f1fb-4faa-af98-f863a4f9e3e4    {&quot;strmMeta&quot;:{&quot;eventContractRef&quot;:&quot;strmprivacy/example/1.3.0&quot;,&quot;nonce&quot;:{&quot;int&quot;:-810110116},&quot;timestamp&quot;:{&quot;long&quot;:1652181101870},&quot;keyLink&quot;:{&quot;string&quot;:&quot;1867d5ad-f1fb-4faa-af98-f863a4f9e3e4&quot;},&quot;billingId&quot;:{&quot;string&quot;:&quot;strmprodccdtest1908747604&quot;},&quot;consentLevels&quot;:[]},&quot;uniqueIdentifier&quot;:{&quot;string&quot;:&quot;AR5VVyfQsta+D1XDKcPiR0sC1oE3yy301W2FMVJ9&quot;},&quot;consistentValue&quot;:&quot;AR5VVydsWvZG+FkvlOFEUZCvlFY4rSpVHs1njIE8tg==&quot;,&quot;someSensitiveValue&quot;:{&quot;string&quot;:&quot;AR5VVyfO8S3djArRlS6ZaI4oefWUjEt9XRnT/f2r6vc=&quot;},&quot;notSensitiveValue&quot;:{&quot;string&quot;:&quot;not-sensitive-84&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5afc9c0a-de67-4e38-bd0a-66640f4349c7    {&quot;strmMeta&quot;:{&quot;eventContractRef&quot;:&quot;strmprivacy/example/1.3.0&quot;,&quot;nonce&quot;:{&quot;int&quot;:1699175479},&quot;timestamp&quot;:{&quot;long&quot;:1652181101896},&quot;keyLink&quot;:{&quot;string&quot;:&quot;5afc9c0a-de67-4e38-bd0a-66640f4349c7&quot;},&quot;billingId&quot;:{&quot;string&quot;:&quot;strmprodccdtest1908747604&quot;},&quot;consentLevels&quot;:[0,1,2,3]},&quot;uniqueIdentifier&quot;:{&quot;string&quot;:&quot;ASotb1YzBuuBBM981rLIzQd/EZA7Em7dxyaBg7vE&quot;},&quot;consistentValue&quot;:&quot;ASotb1bYf1G/2ye4h6ELE4hlkVGZGKSt3LQe0AnZU+k=&quot;,&quot;someSensitiveValue&quot;:{&quot;string&quot;:&quot;ASotb1bb51OCfM9HdCqcAjTLtXqK67EuBQicTpNzIvv/&quot;},&quot;notSensitiveValue&quot;:{&quot;string&quot;:&quot;not-sensitive-95&quot;}}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="exporting-to-an-s3-bucket">Exporting to an S3 bucket<a class="hash-link" href="#exporting-to-an-s3-bucket" title="Direct link to heading">​</a></h3><p>Create the S3 bucket and the associated <code>data connector</code>. See <a href="https://docs.strmprivacy.io/docs/latest/quickstart/batch-exporter/#creating-a-data-connector" target="_blank" rel="noopener noreferrer">here</a> for details
about data connector configuration.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">strm create data-connector s3 s3-connector --credentials-file=...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strm create batch-exporter test-2 --data-connector s3-connector --path-prefix ccd-prod-ovh</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should see a newly-created batch-exporter deployment:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get deployments.apps  -l </span><span class="token assign-left variable" style="color:#36acaa">app</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">batch-exporter</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                                  READY   UP-TO-DATE   AVAILABLE   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">batch-exporter-c726bbff-2b68-4438-ac0d-ee877aa4dabf   1/1     1            1           2m49s</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you&#x27;re sending data, you should see files in your s3 bucket quickly:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">aws s3 </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> s3://stream-machine-export-demo/ccd-prod-ovh/</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">2022-05-10 15:09:21          0 .strm_test_a6c5d566-f851-4778-a7fb-5d39d8958aa4.jsonl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-05-10 15:10:02     131735 2022-05-10T13:10:00-stream-4a35419c-2daf-43ba-8683-7663a0874a35---0-1-2-3-4.jsonl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-05-10 15:11:01     196628 2022-05-10T13:11:00-stream-4a35419c-2daf-43ba-8683-7663a0874a35---0-1-2-3-4.jsonl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-05-10 15:12:01     181281 2022-05-10T13:12:00-stream-4a35419c-2daf-43ba-8683-7663a0874a35---0-1-2-3-4.jsonl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-05-10 15:13:01     202094 2022-05-10T13:13:00-stream-4a35419c-2daf-43ba-8683-7663a0874a35---0-1-2-3-4.jsonl</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Looking inside one of them:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">aws s3 </span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> s3://stream-machine-export-demo/ccd-prod-ovh/2022-05-10T13:12:00-stream-4a35419c-2daf-43ba-8683-7663a0874a35---0-1-2-3-4.jsonl - </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">head</span><span class="token plain"> -1 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> jq</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;strmMeta&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;eventContractRef&quot;: &quot;strmprivacy/example/1.3.0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;nonce&quot;: -1616102758,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;timestamp&quot;: 1652188259519,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;keyLink&quot;: &quot;9e55c3dc-16a3-422b-91e7-b27dffd385e6&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;billingId&quot;: &quot;strmprodccdtest1908747604&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;consentLevels&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;uniqueIdentifier&quot;: &quot;unique-3&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;consistentValue&quot;: &quot;session-453&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;someSensitiveValue&quot;: &quot;AXWnGm/OjbB42PEJuXLwqZX7sRCdSlLInDpNOnJlBxiJ&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;notSensitiveValue&quot;: &quot;not-sensitive-6&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="exporting-to-an-s3-compatible-bucket">Exporting to an S3 compatible bucket<a class="hash-link" href="#exporting-to-an-s3-compatible-bucket" title="Direct link to heading">​</a></h4><p>S3 has become just a protocol instead of an Amazon product. We&#x27;ve tested on a Google Cloud bucket, with HMAC
credentials.</p><p>The short steps:</p><ul><li><p>create a bucket on a Google cloud project: <code>gsutil mb gs://&lt;bucket-name&gt;</code> or via the <a href="https://console.cloud.google.com/storage/create-bucket" target="_blank" rel="noopener noreferrer">gcloud console</a></p></li><li><p>create a service account: <code>gcloud iam service-account create &lt;sa-name&gt;</code></p></li><li><p>give the service account <code>storage.legacyBucketOwner</code> and <code>storage.legacyObjectOwner</code> rights via the <a href="https://console.cloud.google.com/storage/create-bucket" target="_blank" rel="noopener noreferrer">gcloud
console</a></p></li><li><p>create HMAC credentials: <code>gsutil hmac create &lt;sa-name&gt;</code>. Use the secrets in a json file you create
named <code>credentials.json</code></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;url&quot;: &quot;https://storage.googleapis.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;accessKey&quot;: &quot;&lt;access-key&gt;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;secretKey&quot;: &quot;&lt;secret-key&gt;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;api&quot;: &quot;s3v4&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;path&quot;: &quot;auto&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>create a data-connector via the <code>strm</code> cli, with any name you like, but with the bucket name you chose earlier</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">strm create data-connector s3 &lt;name&gt; &lt;bucket-name&gt; --credentials-file=credentials.json</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>create a <code>batch-exporter</code> as described in the <a href="#exporting-to-an-s3-bucket">section above</a>.</p></li></ul><p>We&#x27;ve used the <a href="https://docs.min.io/docs/minio-client-complete-guide.html" target="_blank" rel="noopener noreferrer">minio mc cli tool</a> client to interact with the bucket. Use the credentials you used with
minio:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">mc alias set &lt;alias&gt;  https://storage.googleapis.com &lt;key&gt; &lt;secret-key&gt;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can see the files in the bucket stored at the path prefix you used when creating the batch-exporter</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">mc ls &lt;alias&gt;/&lt;bucket-name&gt;/&lt;path-prefix&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2022-05-17 15:07:01 CEST]  48KiB 2022-05-17T13:07:00-stream-f704507b-1e88-4464-98e0-b7cfa501ec75---0-1-2-3-4.jsonl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2022-05-17 15:08:01 CEST]  44KiB 2022-05-17T13:08:01-stream-f704507b-1e88-4464-98e0-b7cfa501ec75---0-1-2-3-4.jsonl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2022-05-17 15:09:00 CEST]  46KiB 2022-05-17T13:09:00-stream-f704507b-1e88-4464-98e0-b7cfa501ec75---0-1-2-3-4.jsonl</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And have a look inside one of them:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">mc cat gcs/strm-resilience-demo/mc-path/2022-05-17T12:48:00-stream-f704507b-1e88-4464-98e0-b7cfa501ec75---0-1-2-3-4.jsonl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;strmMeta&quot;: {&quot;eventContractRef&quot;: &quot;strmprivacy/example/1.3.0&quot;, &quot;nonce&quot;: 1786601587, &quot;timestamp&quot;: 1652791673944, &quot;keyLink&quot;: &quot;74ddbc8f-86f2-4a08-b32f-1b70a8bc99e8&quot;, &quot;billingId&quot;: &quot;strmprodccdtest1908747604&quot;, &quot;consentLevels&quot;: [0, 1, 2, 3]}, &quot;uniqueIdentifier&quot;: &quot;unique-71&quot;, &quot;consistentValue&quot;: &quot;session-276&quot;, &quot;someSensitiveValue&quot;: &quot;ASn7pHpM/BB1RQvOdI7QD/KVr178KHe8uSCxYBz8NtJY&quot;, &quot;notSensitiveValue&quot;: &quot;not-sensitive-1&quot;}</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="python-example">Python Example<a class="hash-link" href="#python-example" title="Direct link to heading">​</a></h3><p>The <a href="https://docs.strmprivacy.io/docs/latest/quickstart/full-example/" target="_blank" rel="noopener noreferrer">Python example</a> needs a small modification in order to work. In the <code>client_builder.py</code> file change the
<code>config</code> for</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">    config = ClientConfig(log_level=logging.DEBUG,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          gateway_protocol=&quot;http&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          gateway_host=&quot;event-gateway.strmprivacy&quot;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="trying-again">Trying again<a class="hash-link" href="#trying-again" title="Direct link to heading">​</a></h2><p>If you&#x27;ve made mistakes and want to start over:</p><ol><li><code>make uninstall</code> cleanly uninstalls the helm release</li><li><code>kubectl delete ns strmprivacy</code> kills everything (including the k8s namespace). Don&#x27;t forget to recreate the
namespace afterwards.</li></ol><p><code>make wipe</code> combines the above two steps</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/latest/quickstart/simple-schema/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Simple Schema</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/latest/cli-index/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">STRM Privacy CLI reference</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#make-sure-you-are-on-a-self-hosted-subscription" class="table-of-contents__link toc-highlight">Make sure you are on a &#39;Self Hosted&#39; subscription</a></li><li><a href="#install-the-following-tools" class="table-of-contents__link toc-highlight">Install the following tools</a></li><li><a href="#install-the-strm-customer-data-plane" class="table-of-contents__link toc-highlight">Install the STRM customer data plane</a><ul><li><a href="#preparation" class="table-of-contents__link toc-highlight">Preparation</a></li><li><a href="#install-the-helm-chart" class="table-of-contents__link toc-highlight">Install the Helm chart</a></li><li><a href="#create-in-a-different-namespace" class="table-of-contents__link toc-highlight">Create in a different namespace</a></li></ul></li><li><a href="#interacting-with-the-ccd-cluster" class="table-of-contents__link toc-highlight">Interacting with the CCD cluster</a><ul><li><a href="#via-telepresence" class="table-of-contents__link toc-highlight">Via telepresence</a></li><li><a href="#via-port-forwarding" class="table-of-contents__link toc-highlight">Via port forwarding</a></li><li><a href="#consume-from-kafka" class="table-of-contents__link toc-highlight">Consume from Kafka</a></li><li><a href="#exporting-to-an-s3-bucket" class="table-of-contents__link toc-highlight">Exporting to an S3 bucket</a></li><li><a href="#python-example" class="table-of-contents__link toc-highlight">Python Example</a></li></ul></li><li><a href="#trying-again" class="table-of-contents__link toc-highlight">Trying again</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright (C) 2020-2022 STRM Privacy</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b6e123e7.js"></script>
<script src="/assets/js/main.624fc12a.js"></script>
</body>
</html>
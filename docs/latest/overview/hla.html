<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="search" type="application/opensearchdescription+xml" title="STRM Privacy Documentation" href="/opensearch.xml"><title data-react-helmet="true">High Level Architecture | STRM Privacy Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://strmprivacy.github.io/docs/docs/latest/overview/hla"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="High Level Architecture | STRM Privacy Documentation"><meta data-react-helmet="true" name="description" content="This section shows the high level architecture of STRM Privacy. It shows"><meta data-react-helmet="true" property="og:description" content="This section shows the high level architecture of STRM Privacy. It shows"><link data-react-helmet="true" rel="icon" href="/img/favicon.svg"><link data-react-helmet="true" rel="canonical" href="https://strmprivacy.github.io/docs/docs/latest/overview/hla"><link data-react-helmet="true" rel="alternate" href="https://strmprivacy.github.io/docs/docs/latest/overview/hla" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://strmprivacy.github.io/docs/docs/latest/overview/hla" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://M24OHV52F0-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.71f0558d.css">
<link rel="preload" href="/assets/js/runtime~main.49c6a137.js" as="script">
<link rel="preload" href="/assets/js/main.4919953b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://strmprivacy.io" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="https://storage.googleapis.com/strm-media/strm-logo-orange-slim.svg" alt="STRM Privacy Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="https://storage.googleapis.com/strm-media/strm-logo-orange-slim.svg" alt="STRM Privacy Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div></a></div><div class="navbar__items navbar__items--right"><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_VCh3" aria-current="page" href="/docs/latest/overview">Overview</a><button aria-label="Toggle the collapsible sidebar category &#x27;Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/overview/about">About STRM Privacy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/overview/pii">What is Personally Identifiable Information</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/overview/organization">Bringing STRM Privacy into your organization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/latest/overview/hla">High Level Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/overview/definitions">Definitions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/latest/concepts">Concepts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/latest/quickstart">Quickstart</a><button aria-label="Toggle the collapsible sidebar category &#x27;Quickstart&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/latest/cli-index">CLI Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;CLI Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/contact">Contact</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->latest</span><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Architecture</h1><p>This section shows the high level architecture of STRM Privacy. It shows
how data is processed, before it is exposed to an application consuming
the data.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="overview">Overview<a class="hash-link" href="#overview" title="Direct link to heading">â€‹</a></h2><p>When sending data or receiving data to/from STRM Privacy, your
application must identify itself using client credentials. These
credentials are provided through the self-service console or via the
<code>strm</code> command line interface.</p><p>All events that are being sent to STRM Privacy have schema reference (in
a http header) that defines the structure and contents of the event.</p><p>The STRM Privacy <em>Event Gateway</em> will verify that the data:</p><ol><li><p>â€¦is of the correct serialization format, as specified in schema
reference</p></li><li><p>â€¦is a valid serialized message</p></li><li><p>â€¦complies to the pre-defined validation rules, as specified in the
Event Contract</p></li></ol><p><img alt="High Level Architecture" src="/assets/images/hla-5d292c63e1b73b2bf470782fcde0adc5.svg" width="939" height="432"></p><p>Upon accepting an event, the <em>Event Gateway</em> will use the <em>Encrypter</em> to
encrypt <strong>all</strong> defined Personally Identifiable Information (PII)
attributes of the event. Which fields are PII is defined in the event
contract, for example <a href="https://strmprivacy.io/schemas/media-personalization/" target="_blank" rel="noopener noreferrer">the media personalization event
contract</a>. The
schema can have multiple levels of PII attributes but all of them are
encrypted with the same encryption key that is linked to the session.
This key is rotated every 24 hours.</p><p>You <em>can</em> <sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup> create decrypted streams that contain a subset of the
encrypted stream, with only those PII fields decrypted that you have
requested.</p><p>The algorithm is as follows:</p><ul><li><p>we define a derived stream where for example we request to receive
events that provide consent for levels 1, 3 and 8.</p></li><li><p>the decrypter will inspect every event, and will ignore all events
that donâ€™t have <em>at least</em> these 3 levels set in their
<code>consentLevels</code> <a href="/docs/latest/concepts/strm-meta">meta-data</a>.</p></li><li><p>the events that are accepted by the decrypter will then be partially
decrypted; only the attributes with PII levels 1, 3 and 8 will be
decrypted. This means that assuming a customer has given consent for
a couple more PII levels, fields with those consent levels will
<strong>not be decrypted</strong>. This is the mechanism that STRM Privacy uses
to adhere to <a href="https://gdpr-info.eu/art-6-gdpr/" target="_blank" rel="noopener noreferrer">article 6 of the
GDPR</a>. A data processing unit in a
company receives only those events that the end-user has consented
to, with only those PII data that it needs.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="outputs">Outputs<a class="hash-link" href="#outputs" title="Direct link to heading">â€‹</a></h2><p>STRM Privacy has multiple output possibilities.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-batch-exporters">The Batch Exporters<a class="hash-link" href="#the-batch-exporters" title="Direct link to heading">â€‹</a></h3><p>Currently STRM Privacy has two batch exporter outputs, for <em>AWS S3</em>, and
<em>Google Cloud Storage</em>. These can be configured to receive batches of
JSON formatted events of encrypted streams or output streams. See
<a href="/docs/latest/quickstart/receiving-s3">here</a> for an example.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="kafka-consumer">Kafka Consumer<a class="hash-link" href="#kafka-consumer" title="Direct link to heading">â€‹</a></h3><p>STRM Privacy is built on <a href="https://kafka.apache.org/powered-by" target="_blank" rel="noopener noreferrer">Apache
Kafka</a>, which provides it with very
good scalability, fault-tolerance and decoupling of event producers and
consumers. See <a href="/docs/latest/quickstart/exporting-kafka">here</a> for an
introduction on how to consume input or derived streams from our Kafka
cluster.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="encryption-keys">Encryption Keys<a class="hash-link" href="#encryption-keys" title="Direct link to heading">â€‹</a></h3><p>It is possible to move the decryption of events to the customers own
environment. In that case the client will receive the encryption keys
(in <a href="https://developers.google.com/tink" target="_blank" rel="noopener noreferrer">tink</a> format) via a batch
exporter mechanism. See <a href="/docs/latest/quickstart/exporting-keys">the Exporting
Keys</a> documentation for some details.</p><p>In case the customer choose to receive and use the decryption keys to
decrypt personal data attributes, the responsibility for correctly
dealing with privacy compliance moves to the customer teams and
processes.</p><p><sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup> but donâ€™t have to</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/latest/overview/organization"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Bringing STRM Privacy into your organization</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/latest/overview/definitions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Definitions</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#outputs" class="table-of-contents__link toc-highlight">Outputs</a><ul><li><a href="#the-batch-exporters" class="table-of-contents__link toc-highlight">The Batch Exporters</a></li><li><a href="#kafka-consumer" class="table-of-contents__link toc-highlight">Kafka Consumer</a></li><li><a href="#encryption-keys" class="table-of-contents__link toc-highlight">Encryption Keys</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright (C) 2020-2022 STRM Privacy</div></div></div></footer></div>
<script src="/assets/js/runtime~main.49c6a137.js"></script>
<script src="/assets/js/main.4919953b.js"></script>
</body>
</html>